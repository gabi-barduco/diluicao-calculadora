<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Dilui√ß√£o de Proca√≠na</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <h1>üî¨ Calculadora de Dilui√ß√£o de Proca√≠na üíâ</h1>
  <p class="intro">Use esta ferramenta para calcular volumes de proca√≠na e soro. Preencha os campos conforme desejado e siga os passos abaixo.</p>

  <div class="section">
    <h2>üìå Passo 1: Concentra√ß√£o da Proca√≠na</h2>
    <p>Informe a concentra√ß√£o inicial da solu√ß√£o de proca√≠na e a concentra√ß√£o final que deseja obter.</p>
    <label for="concInicial">Concentra√ß√£o Inicial (%)</label>
    <input type="number" id="concInicial" step="0.01">
    <label for="concFinal">Concentra√ß√£o Final Desejada (%)</label>
    <input type="number" id="concFinal" step="0.01">
  </div>

  <div class="section">
    <h2>üß™ Passo 2: Volume</h2>
    <p>Informe um dos volumes: o volume final desejado ou o volume de soro dispon√≠vel. Se preencher ambos, o resultado mostrar√° os dois c√°lculos.</p>
    <label for="volFinal">Volume Final Desejado (mL)</label>
    <input type="number" id="volFinal" step="0.01">
    <label for="volSoro">Volume de Soro Dispon√≠vel (mL)</label>
    <input type="number" id="volSoro" step="0.01">
  </div>

  <div class="buttons">
    <button class="calc" onclick="calcularDilui√ß√£o()">üßÆ Calcular</button>
    <button class="save" onclick="salvarResultado()">üíæ Salvar Resultado</button>
    <button class="clear" onclick="limparTudo()">üóëÔ∏è Limpar</button>
    <button class="export" onclick="exportarHistorico()">üì§ Exportar Hist√≥rico</button>
  </div>

  <div id="resultado">O resultado aparecer√° aqui.</div>
  <div id="historico"><strong>üìú Hist√≥rico:</strong><br></div>
</div>

<footer>
  <p><strong>Nivea Schrann</strong> - Farmac√™utica / Terapeuta Neural<br>
  üì∑ <a href="https://www.instagram.com/niveamariaschrann" target="_blank">@niveamariaschrann</a> | 
  üìû <a href="https://wa.me/5541999146610" target="_blank">(41) 99914-6610</a></p>
</footer>

<script>
function calcularDilui√ß√£o() {
  let ci = parseFloat(document.getElementById("concInicial").value);
  let cf = parseFloat(document.getElementById("concFinal").value);
  let vf = parseFloat(document.getElementById("volFinal").value);
  let vs = parseFloat(document.getElementById("volSoro").value);
  let resultado = "";

  if (isNaN(ci) || isNaN(cf)) {
    resultado = "‚ö†Ô∏è Preencha as concentra√ß√µes corretamente.";
  } else if (cf > ci) {
    resultado = "‚ö†Ô∏è A concentra√ß√£o final n√£o pode ser maior que a inicial.";
  } else {
    let r1 = "", r2 = "";
    if (!isNaN(vf)) {
      let volProca√≠na = (cf * vf)/ci;
      let volSoro = vf - volProca√≠na;
      r1 = `‚úÖ Para obter ${vf} mL de solu√ß√£o a ${cf}%:\n‚û°Ô∏è ${volProca√≠na.toFixed(2)} mL de proca√≠na\n‚û°Ô∏è ${volSoro.toFixed(2)} mL de soro\n\n`;
    }
    if (!isNaN(vs)) {
      let volProca√≠na = (cf * vs)/(ci - cf);
      let volTotal = volProca√≠na + vs;
      r2 = `‚úÖ Com ${vs} mL de soro:\n‚û°Ô∏è ${volProca√≠na.toFixed(2)} mL de proca√≠na\n‚û°Ô∏è ${vs.toFixed(2)} mL de soro\nüìè Volume final: ${volTotal.toFixed(2)} mL`;
    }
    resultado = r1 + r2 || "‚ö†Ô∏è Preencha pelo menos um campo de volume.";
  }
  document.getElementById("resultado").innerText = resultado;
}

function salvarResultado() {
  let res = document.getElementById("resultado").innerText;
  if (!res || res.includes("‚ö†Ô∏è")) return;
  let hist = JSON.parse(localStorage.getItem("historicoDilui√ß√µes")) || [];
  hist.push(res);
  localStorage.setItem("historicoDilui√ß√µes", JSON.stringify(hist));
  mostrarHistorico();
}

function mostrarHistorico() {
  let div = document.getElementById("historico");
  let hist = JSON.parse(localStorage.getItem("historicoDilui√ß√µes")) || [];
  div.innerHTML = "<strong>üìú Hist√≥rico:</strong><br>" + hist.map((h,i)=>`#${i+1}: ${h}`).join("<br><br>");
}

function limparTudo() {
  document.getElementById("concInicial").value="";
  document.getElementById("concFinal").value="";
  document.getElementById("volFinal").value="";
  document.getElementById("volSoro").value="";
  document.getElementById("resultado").innerText="O resultado aparecer√° aqui.";
}

function exportarHistorico() {
  let hist = JSON.parse(localStorage.getItem("historicoDilui√ß√µes")) || [];
  if(hist.length===0) return;
  let conteudo = "Hist√≥rico de Dilui√ß√µes:\n\n" + hist.join("\n\n");
  let blob = new Blob([conteudo],{type:"text/plain"});
  let link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "historico_diluicoes.txt";
  link.click();
}

window.onload = mostrarHistorico;
</script>
</body>
</html>
